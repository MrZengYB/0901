import{A as b,w as l,br as p,bs as g,bt as B,l as a,p as m,Q as w,H as A}from"./index.f735b5c1.js";import{s as f}from"./useBVHMap.89d4dfff.1033c271.js";b(()=>{const r=f();if(!r.length){const t=l(p);return()=>{t.cancel()}}const h=l(()=>{p();for(const t of g){t.updateMatrixWorld();const i=B(t),{start:s,end:d}=m;d.copy(s.copy(t.position)),a.makeEmpty(),a.expandByPoint(s),a.min.addScalar(-.5),a.max.addScalar(.5);const u=w,x=A;let o=0,n=0;for(const S of r)S.shapecast({intersectsBounds:c=>c.intersectsBox(a),intersectsTriangle:c=>{o=c.closestPointToSegment(m,u,x),o<.5&&(n=.5-o,s.addScaledVector(i,n),d.addScaledVector(i,n))}});const e=s.sub(t.position),y=Math.max(0,e.length()-1e-5);e.normalize().multiplyScalar(y),t.position.add(e)}});return()=>{h.cancel()}},[f]);
